parser ArithParser where

tokens '+' { Token.Plus }
     | '*' { Token.Times }
     | '(' { Token.LParen }
     | ')' { Token.RParen }

rules

start expr = term terms { foldl op+ factor factors }

terms
    = '+' term terms { term :: terms }
    |                { [] }

term = factor factors { foldl op* factor factors }

factors
    = '*' factor factors { factor :: factors }
    |                    { [] }

factor
    = '(' expr ')' { expr }
    | DIGIT        { DIGIT }

